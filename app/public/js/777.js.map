{"version":3,"file":"js/777.js","mappings":"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","sources":["webpack:///./resources/js/config/axios.js","webpack:///./resources/js/pages/admin/DM_MauTieuChi/ModalChiTiet/index.js","webpack:///./resources/js/pages/admin/DM_MauTieuChi/ModalChiTiet/style.scss","webpack:///./resources/js/pages/admin/DM_MauTieuChi/ModalChiTiet/style.scss?1888"],"sourcesContent":["\r\nimport * as Axios from \"axios\";\r\n\r\nlet token = document.head.querySelector('meta[name=\"csrf-token\"]');\r\n\r\nconst axios = Axios.default.create({\r\n    baseURL: '/',\r\n    responseType: 'json',\r\n    // timeout: 1000,\r\n    // headers: {\r\n    //     'Accept': 'application/json'\r\n    // }\r\n})\r\n\r\nexport {\r\n    axios\r\n}","import React, { forwardRef, memo, useCallback, useImperativeHandle, useMemo, useState } from \"react\";\nimport { Button, Col, Form, Input, InputNumber, Modal, notification, Radio, Row, Space, Table, Tooltip } from \"antd\";\nimport useForm from \"antd/lib/form/hooks/useForm\";\nimport { axios } from \"../../../../config\";\nimport { isEmpty, range, set } from \"lodash-es\";\nimport { PlusOutlined, DeleteOutlined } from \"@ant-design/icons\";\n\nimport './style.scss'\nimport { setIDTree, addNode, removeNode, setValuesTree } from \"../../../../utils\";\n\nlet genarateID = setIDTree()\n\nconst ModalChiTiet = forwardRef(({\n\n}, ref) => {\n\n    const [visible, setVisible] = useState(false)\n    const [loading, setLoading] = useState(false)\n    const [dataChiTiet, setDataChiTiet] = useState([])\n    const [item, setItem] = useState(null);\n    const [editable, setEditable] = useState(false);\n    const [total, setTotal] = useState(0)\n    const [diemHocTap, setDiemHocTap] = useState(null)\n    const [form] = useForm()\n\n    const loadData = useCallback((id) => {\n        setLoading(true)\n        axios.get(`admin/DM_MauTieuChi/${id}/tieuchi-chitiet`)\n            .then(res => {\n                const [newData, text, point, total, diemHocTap] = genarateID.renderTree(res?.data || [], true)\n                setDataChiTiet(newData)\n                setTotal(total)\n                setDiemHocTap(diemHocTap)\n                form?.setFieldsValue({\n                    ...text,\n                    ...point\n                })\n            })\n            .finally(() => setLoading(false))\n    }, [])\n\n    const showModal = useCallback((itemInput) => {\n        setItem(itemInput)\n        loadData(itemInput?.id)\n        setVisible(true)\n    }, [])\n\n    useImperativeHandle(ref, () => ({\n        showModal\n    }))\n\n    const hiddenModal = useCallback(() => {\n        setVisible(false)\n        genarateID = setIDTree()\n        setDataChiTiet([])\n    }, [])\n\n    const onSubmit = useCallback(async () => {\n        try {\n            await form?.validateFields()\n        } catch (error) {\n            return\n        }\n        setLoading(true)\n        axios.put(`admin/DM_MauTieuChi/${item?.id}/update-tieuchi`, {\n            tree: dataChiTiet,\n            diemHocTap\n        })\n            .then(res => {\n                console.log(res)\n                notification.success({\n                    message: 'Cập nhật thành công'\n                })\n                setEditable(false)\n            })\n            .catch(err => {\n                notification.warning({\n                    message: err?.response?.data?.message || 'Cập nhật thất bại'\n                })\n            })\n            .finally(() => setLoading(false))\n    }, [item, dataChiTiet, diemHocTap])\n\n    const onAddNode = useCallback((id) => {\n        setEditable(true)\n        setDataChiTiet(data => {\n            const newData = addNode(data, id)\n            const [finalData, text, point, total] = genarateID.renderTree(newData, false)\n            setTotal(total)\n            form?.setFieldsValue({\n                ...text,\n                ...point\n            })\n            return [...finalData]\n        })\n    }, [])\n\n    const onRemoveNode = useCallback((id) => {\n        setEditable(true)\n        setDataChiTiet(data => {\n            const newData = removeNode(data, id)\n            const [finalData, text, point, total] = genarateID.renderTree(newData, false)\n            setTotal(total)\n            form?.setFieldsValue({\n                ...text,\n                ...point\n            })\n            return [...finalData]\n        })\n    }, [])\n\n    const onChangeValue = useCallback((id, value, type) => {\n        setEditable(true)\n        setDataChiTiet(data => {\n            const newData = setValuesTree(data, id, value, type)\n            const [finalData, text, point, total] = genarateID.renderTree(newData, false)\n            setTotal(total)\n            form?.setFieldsValue({\n                ...text,\n                ...point\n            })\n            return [...finalData]\n        })\n    }, [])\n\n    const columns = useMemo(() => ([\n        {\n            title: 'Tiêu chí',\n            dataIndex: 'TenTieuChi',\n            key: 'TenTieuChi',\n            render: (text, record) => (\n                (\n                    <Row>\n                        <Col span={2}>\n                            <p style={record?.level === 1 ?\n                                { fontWeight: 'bold', fontSize: '18px' } :\n                                record?.level === 2 ? { fontStyle: 'italic', fontSize: '16px' } : {}}>\n                                {`${record?.indexs?.join('.')}.`}\n                            </p>\n                        </Col>\n                        <Col span={22}>\n                            <Form.Item name={`TenTieuChi-${record?.id}`} style={{ margin: 0 }} rules={[ {required: true, message: 'Nhập tiêu chí'} ]}>\n                                <Input onChange={(value) => onChangeValue(record?.id, value?.target?.value, 'TenTieuChi')} />\n                            </Form.Item>\n                        </Col>\n                    </Row>\n                )\n            )\n\n        },\n        {\n            title: () => (\n                <>\n                    <p>Số điểm</p>\n                    <p>({total})</p>\n                </>\n            ),\n            dataIndex: 'SoDiem',\n            key: 'SoDiem',\n            width: 150,\n            className: 'cell-center',\n            render: (text, record) => (\n                <Form.Item name={`SoDiem-${record?.id}`} style={{ margin: 0 }}>\n                    <InputNumber disabled={!isEmpty(record?.children)} onChange={(value) => onChangeValue(record?.id, value, 'SoDiem')} />\n                </Form.Item>\n            )\n        },\n        {\n            title: () => (\n                <Space size='middle'>\n                    <Tooltip title=\"Thêm mới trước\">\n                        <Button\n                            type='primary'\n                            icon={<PlusOutlined />}\n                            onClick={() => onAddNode(-1)}\n                        />\n                    </Tooltip>\n                    <Tooltip title=\"Thêm mới sau\">\n                        <Button\n                            type='primary'\n                            icon={<PlusOutlined />}\n                            onClick={() => onAddNode(-2)}\n                        />\n                    </Tooltip>\n                </Space>\n            ),\n            dataIndex: 'action',\n            key: 'action',\n            className: 'cell-center',\n            width: 200,\n            fixed: 'right',\n            render: (text, record) => (\n                <Space size='middle'>\n                    <Tooltip title=\"Thêm mới\">\n                        <Button\n                            type='primary'\n                            icon={<PlusOutlined />}\n                            onClick={() => onAddNode(record?.id)}\n                        />\n                    </Tooltip>\n                    <Tooltip title=\"Xóa\">\n                        <Button\n                            type='dashed'\n                            icon={<DeleteOutlined />}\n                            onClick={() => onRemoveNode(record?.id)}\n                        />\n                    </Tooltip>\n                </Space>\n            )\n        }\n    ]), [total])\n\n    return (\n        <Modal\n            visible={visible}\n            okButtonProps={{\n                loading,\n                disabled: !editable\n            }}\n            onCancel={hiddenModal}\n            onOk={onSubmit}\n            width={1500}\n            okText='Cập nhật'\n            cancelText='Hủy'\n            centered\n            maskClosable={false}\n            title={`Cập nhật tiêu chí - ${item?.TenMauTieuChi}`}\n        >\n            <Form\n                name=\"basic\"\n                form={form}\n            >\n                <Table\n                    expandable={{\n                        defaultExpandAllRows: true,\n                        expandedRowKeys: range(200),\n                        expandIcon: null,\n                        indentSize: 20\n                    }}\n                    rowSelection={{\n                        type: 'radio',\n                        columnTitle: 'Điểm học tập',\n                        selectedRowKeys: [diemHocTap],\n                        onSelect: (record) => {\n                            if (record.children && record.children.length > 0) return\n                            setDiemHocTap(record.id);\n                            // console.log(record);\n                        }\n                    }}\n                    rowKey={(v) => v?.id}\n                    bordered\n                    columns={columns}\n                    dataSource={dataChiTiet}\n                    loading={loading}\n                    style={{\n                        height: 'calc(100vh - 200px)',\n                        maxHeight: 'calc(100vh - 200px)'\n                    }}\n                    pagination={false}\n                    scroll={{\n                        x: 800,\n                        y: 'calc(100vh - 300px)'\n                    }}\n                />\n            </Form>\n        </Modal>\n    )\n\n})\n\nexport default memo(ModalChiTiet)","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".cell-center{text-align:center}\", \"\",{\"version\":3,\"sources\":[\"webpack://./resources/js/pages/admin/DM_MauTieuChi/ModalChiTiet/style.scss\"],\"names\":[],\"mappings\":\"AAAA,aACI,iBACJ\",\"sourcesContent\":[\".cell-center {\\n    text-align: center;\\n }\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import api from \"!../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].oneOf[1].use[1]!../../../../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[7].oneOf[1].use[2]!../../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[7].oneOf[1].use[3]!./style.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};"],"names":["axios","document","head","querySelector","Axios","baseURL","responseType","genarateID","setIDTree","ModalChiTiet","forwardRef","ref","useState","visible","setVisible","loading","setLoading","dataChiTiet","setDataChiTiet","item","setItem","editable","setEditable","total","setTotal","diemHocTap","setDiemHocTap","form","useForm","loadData","useCallback","id","then","res","renderTree","data","newData","text","point","setFieldsValue","showModal","itemInput","useImperativeHandle","hiddenModal","onSubmit","validateFields","tree","console","log","message","err","response","onAddNode","addNode","finalData","onRemoveNode","removeNode","onChangeValue","value","type","setValuesTree","columns","useMemo","title","dataIndex","key","render","record","span","style","level","fontWeight","fontSize","fontStyle","indexs","join","name","margin","rules","required","onChange","target","width","className","disabled","isEmpty","children","size","icon","onClick","fixed","okButtonProps","onCancel","onOk","okText","cancelText","centered","maskClosable","TenMauTieuChi","expandable","defaultExpandAllRows","expandedRowKeys","range","expandIcon","indentSize","rowSelection","columnTitle","selectedRowKeys","onSelect","length","rowKey","v","bordered","dataSource","height","maxHeight","pagination","scroll","x","y","memo","___CSS_LOADER_EXPORT___","push","module","options"],"sourceRoot":""}