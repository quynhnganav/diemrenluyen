"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[755,700],{7461:(n,e,r)=>{r.d(e,{o:()=>i});var t=r(9669),i=r.n(t)().create({baseURL:"/"})},4755:(n,e,r)=>{r.r(e),r.d(e,{default:()=>z});var t=r(7016),i=r(6684),l=r(9650),o=r(7066),u=r(1577),a=r(8835),c=r(1230),d=r(4561),s=r(5779),f=r(5746),h=r(8648),v=r(7294),m=r(3284),p=r(7461),y=r(1426),b=r(7105),g=r(9101),x=r(3171),j=(r(4700),r(6486));function C(n){return function(n){if(Array.isArray(n))return T(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"==typeof n)return T(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(n);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}var S=function(){var n=0,e=function e(r,t,i){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;i?r.id=++n:null!=r&&r.id||(r.id=++n),r.root=t,r.level=++l,r.indexs=o,u["TenTieuChi-".concat(r.id)]=(null==r?void 0:r.TenTieuChi)||"";var c,d=(null==r?void 0:r.SoDiem)||0;(0,j.isEmpty)(r.children)?delete r.children:(d=0,null==r||null===(c=r.children)||void 0===c||c.forEach((function(n,r){d+=e(n,!1,i,l,[].concat(C(o),[r+1]),u,a)})));return a["SoDiem-".concat(r.id)]=d,d};return{renderTree:function(n,r){var t={},i={},l=0;return null==n||n.forEach((function(n,o){l+=e(n,!0,r,0,[o+1],t,i)})),[n,t,i,l]},getIdCurrent:function(){return++n}}},Z=r(5893);function w(n){return function(n){if(Array.isArray(n))return E(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||D(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,t)}return r}function O(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){A(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function A(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function I(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==r)return;var t,i,l=[],o=!0,u=!1;try{for(r=r.call(n);!(o=(t=r.next()).done)&&(l.push(t.value),!e||l.length!==e);o=!0);}catch(n){u=!0,i=n}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return l}(n,e)||D(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(n,e){if(n){if("string"==typeof n)return E(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(n,e):void 0}}function E(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}var P=S(),M=(0,v.forwardRef)((function(n,e){!function(n){if(null==n)throw new TypeError("Cannot destructure undefined")}(n);var r=I((0,v.useState)(!1),2),C=r[0],T=r[1],k=I((0,v.useState)(!1),2),A=k[0],D=k[1],E=I((0,v.useState)([]),2),M=E[0],z=E[1],F=I((0,v.useState)(null),2),R=F[0],V=F[1],B=I((0,v.useState)(!1),2),H=B[0],U=B[1],K=I((0,v.useState)(0),2),N=K[0],$=K[1],_=I((0,m.default)(),1)[0],L=(0,v.useCallback)((function(n){D(!0),p.o.get("admin/DM_MauTieuChi/".concat(n,"/tieuchi-chitiet")).then((function(n){var e=I(P.renderTree((null==n?void 0:n.data)||[],!0),4),r=e[0],t=e[1],i=e[2],l=e[3];z(r),$(l),null==_||_.setFieldsValue(O(O({},t),i))})).finally((function(){return D(!1)}))}),[]),W=(0,v.useCallback)((function(n){V(n),L(null==n?void 0:n.id),T(!0)}),[]);(0,v.useImperativeHandle)(e,(function(){return{showModal:W}}));var X=(0,v.useCallback)((function(){T(!1),P=S(),z([])}),[]),q=(0,v.useCallback)((function(){D(!0),p.o.put("admin/DM_MauTieuChi/".concat(null==R?void 0:R.id,"/update-tieuchi"),{tree:M}).then((function(n){console.log(n),h.Z.success({message:"Cập nhật thành công"}),U(!1)})).catch((function(n){var e,r;h.Z.warning({message:(null==n||null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||"Cập nhật thất bại"})})).finally((function(){return D(!1)}))}),[R,M]),G=(0,v.useCallback)((function(n){U(!0),z((function(e){var r=function(n,e){var r=function n(e,r){var t;if(r==(null==e?void 0:e.id))return null!=e&&e.children||(e.children=[]),null==e||null===(t=e.children)||void 0===t||t.push({TenTieuChi:"",SoDiem:0,Css:""}),!0;if(!(0,j.isEmpty)(e.children))for(var i=0;i<(null==e||null===(l=e.children)||void 0===l?void 0:l.length);i++){var l;if(n(null==e?void 0:e.children[i],r))return!0}return!1};if(-1===e)return n.unshift({TenTieuChi:"",SoDiem:0,Css:""}),n;if(-2===e)return n.push({TenTieuChi:"",SoDiem:0,Css:""}),n;for(var t=0;t<n.length;t++)if(r(n[t],e))return n;return n}(e,n),t=I(P.renderTree(r,!1),4),i=t[0],l=t[1],o=t[2],u=t[3];return $(u),null==_||_.setFieldsValue(O(O({},l),o)),w(i)}))}),[]),J=(0,v.useCallback)((function(n){U(!0),z((function(e){var r=function(n,e){for(var r=function n(e,r){var t;if((0,j.isEmpty)(null==e?void 0:e.children))return null;if(null!=e&&null!==(t=e.children)&&void 0!==t&&t.find((function(n){return(null==n?void 0:n.id)==r})))return e.children=(0,j.differenceBy)(null==e?void 0:e.children,[{id:r}],"id"),!0;if(!(0,j.isEmpty)(e.children))for(var i=0;i<(null==e||null===(l=e.children)||void 0===l?void 0:l.length);i++){var l;if(n(null==e?void 0:e.children[i],r))return!0}return!1},t=0;t<n.length;t++){var i=n[t];if((null==i?void 0:i.id)==e)return(0,j.differenceBy)(n,[{id:e}],"id");if(r(i,e))return n}return n}(e,n),t=I(P.renderTree(r,!1),4),i=t[0],l=t[1],o=t[2],u=t[3];return $(u),null==_||_.setFieldsValue(O(O({},l),o)),w(i)}))}),[]),Q=(0,v.useCallback)((function(n,e,r){U(!0),z((function(t){var i=function(n,e,r,t){for(var i=function n(e,r,t,i){if((null==e?void 0:e.id)==r)return e[i]=t,!0;if(!(0,j.isEmpty)(e.children))for(var l=0;l<(null==e||null===(o=e.children)||void 0===o?void 0:o.length);l++){var o;if(n(null==e?void 0:e.children[l],r,t,i))return!0}return!1},l=0;l<n.length;l++){var o=n[l];if((null==o?void 0:o.id)==e)return o[t]=r,n;if(i(o,e,r,t))return n}return n}(t,n,e,r),l=I(P.renderTree(i,!1),4),o=l[0],u=l[1],a=l[2],c=l[3];return $(c),null==_||_.setFieldsValue(O(O({},u),a)),w(o)}))}),[]),Y=(0,v.useMemo)((function(){return[{title:"Tiêu chí",dataIndex:"TenTieuChi",key:"TenTieuChi",render:function(n,e){var r;return(0,Z.jsxs)(c.Z,{children:[(0,Z.jsx)(f.Z,{span:2,children:(0,Z.jsx)("p",{style:1===(null==e?void 0:e.level)?{fontWeight:"bold",fontSize:"18px"}:2===(null==e?void 0:e.level)?{fontStyle:"italic",fontSize:"16px"}:{},children:"".concat(null==e||null===(r=e.indexs)||void 0===r?void 0:r.join("."),".")})}),(0,Z.jsx)(f.Z,{span:22,children:(0,Z.jsx)(d.Z.Item,{name:"TenTieuChi-".concat(null==e?void 0:e.id),style:{margin:0},children:(0,Z.jsx)(s.Z,{onChange:function(n){var r;return Q(null==e?void 0:e.id,null==n||null===(r=n.target)||void 0===r?void 0:r.value,"TenTieuChi")}})})})]})}},{title:function(){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:"Số điểm"}),(0,Z.jsxs)("p",{children:["(",N,")"]})]})},dataIndex:"SoDiem",key:"SoDiem",width:150,className:"cell-center",render:function(n,e){return(0,Z.jsx)(d.Z.Item,{name:"SoDiem-".concat(null==e?void 0:e.id),style:{margin:0},children:(0,Z.jsx)(a.Z,{disabled:!(0,y.Z)(null==e?void 0:e.children),onChange:function(n){return Q(null==e?void 0:e.id,n,"SoDiem")}})})}},{title:function(){return(0,Z.jsxs)(l.Z,{size:"middle",children:[(0,Z.jsx)(o.Z,{title:"Thêm mới trước",children:(0,Z.jsx)(u.Z,{type:"primary",icon:(0,Z.jsx)(g.Z,{}),onClick:function(){return G(-1)}})}),(0,Z.jsx)(o.Z,{title:"Thêm mới sau",children:(0,Z.jsx)(u.Z,{type:"primary",icon:(0,Z.jsx)(g.Z,{}),onClick:function(){return G(-2)}})})]})},dataIndex:"action",key:"action",className:"cell-center",width:200,fixed:"right",render:function(n,e){return(0,Z.jsxs)(l.Z,{size:"middle",children:[(0,Z.jsx)(o.Z,{title:"Thêm mới",children:(0,Z.jsx)(u.Z,{type:"primary",icon:(0,Z.jsx)(g.Z,{}),onClick:function(){return G(null==e?void 0:e.id)}})}),(0,Z.jsx)(o.Z,{title:"Xóa",children:(0,Z.jsx)(u.Z,{type:"dashed",icon:(0,Z.jsx)(x.Z,{}),onClick:function(){return J(null==e?void 0:e.id)}})})]})}}]}),[N]);return(0,Z.jsx)(t.Z,{visible:C,okButtonProps:{loading:A,disabled:!H},onCancel:X,onOk:q,width:1500,okText:"Cập nhật",cancelText:"Hủy",centered:!0,maskClosable:!1,title:"Cập nhật tiêu chí - ".concat(null==R?void 0:R.TenMauTieuChi),children:(0,Z.jsx)(d.Z,{name:"basic",form:_,children:(0,Z.jsx)(i.Z,{expandable:{defaultExpandAllRows:!0,expandedRowKeys:(0,b.Z)(200),expandIcon:null,indentSize:20},rowKey:function(n){return null==n?void 0:n.id},bordered:!0,columns:Y,dataSource:M,loading:A,style:{height:"calc(100vh - 200px)",maxHeight:"calc(100vh - 200px)"},pagination:!1,scroll:{x:800,y:"calc(100vh - 250px)"}})})})}));const z=(0,v.memo)(M)},1349:(n,e,r)=>{r.d(e,{Z:()=>l});var t=r(3645),i=r.n(t)()((function(n){return n[1]}));i.push([n.id,".cell-center{text-align:center}",""]);const l=i},4700:(n,e,r)=>{r.r(e),r.d(e,{default:()=>u});var t=r(3379),i=r.n(t),l=r(1349),o={insert:"head",singleton:!1};i()(l.Z,o);const u=l.Z.locals||{}}}]);